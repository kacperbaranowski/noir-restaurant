---
const navLinks = [
  { href: '/o-nas', label: 'O nas' },
  { href: '/menu', label: 'Menu' },
  { href: '/rezerwacja', label: 'Rezerwacja' },
  { href: '/kontakt', label: 'Kontakt' },
];
---

<nav class="nav fixed top-0 left-0 w-full px-6 lg:px-16 py-5 lg:py-6 flex justify-between items-center z-50 transition-all duration-500">
  <a href="/" class="magnetic font-[family-name:var(--font-display)] text-xl lg:text-2xl font-normal tracking-[0.3em] text-[var(--color-text)] no-underline z-50">
    NOIR
  </a>

  <!-- Desktop Menu -->
  <ul class="hidden lg:flex gap-12 list-none">
    {navLinks.map((link) => (
      <li>
        <a
          href={link.href}
          class="nav-link magnetic relative font-[family-name:var(--font-body)] text-xs font-light tracking-[0.2em] uppercase text-[var(--color-text)] no-underline py-2"
        >
          {link.label}
        </a>
      </li>
    ))}
  </ul>

  <!-- Desktop CTA -->
  <a
    href="/rezerwacja"
    class="hidden lg:block magnetic font-[family-name:var(--font-body)] text-xs font-normal tracking-[0.2em] uppercase text-[var(--color-bg)] bg-[var(--color-text)] px-8 py-4 no-underline transition-all duration-400 hover:bg-[var(--color-accent)] hover:text-[var(--color-bg)]"
  >
    Rezerwuj
  </a>

  <!-- Hamburger Button -->
  <button
    id="menu-toggle"
    class="lg:hidden relative z-50 w-10 h-10 flex flex-col justify-center items-center gap-1.5"
    aria-label="Menu"
  >
    <span class="hamburger-line w-6 h-px bg-[var(--color-text)] transition-all duration-300"></span>
    <span class="hamburger-line w-6 h-px bg-[var(--color-text)] transition-all duration-300"></span>
  </button>
</nav>

<!-- Mobile Menu -->
<div id="mobile-menu" class="mobile-menu fixed inset-0 bg-[var(--color-bg)] z-40 flex flex-col items-center justify-center opacity-0 pointer-events-none transition-opacity duration-500">
  <ul class="list-none text-center space-y-8">
    {navLinks.map((link) => (
      <li>
        <a
          href={link.href}
          class="mobile-link font-[family-name:var(--font-display)] text-4xl font-light text-[var(--color-text)] no-underline transition-colors duration-300 hover:text-[var(--color-accent)]"
        >
          {link.label}
        </a>
      </li>
    ))}
  </ul>

  <a
    href="/rezerwacja"
    class="mt-12 font-[family-name:var(--font-body)] text-sm font-normal tracking-[0.2em] uppercase text-[var(--color-bg)] bg-[var(--color-accent)] px-10 py-4 no-underline"
  >
    Zarezerwuj Stolik
  </a>
</div>

<script>
  const nav = document.querySelector('.nav');
  const menuToggle = document.getElementById('menu-toggle');
  const mobileMenu = document.getElementById('mobile-menu');
  const hamburgerLines = document.querySelectorAll('.hamburger-line');
  let isOpen = false;

  function handleScroll() {
    if (window.scrollY > 50) {
      nav?.classList.add('nav-scrolled');
    } else {
      nav?.classList.remove('nav-scrolled');
    }
  }

  function toggleMenu() {
    isOpen = !isOpen;

    if (isOpen) {
      mobileMenu?.classList.remove('opacity-0', 'pointer-events-none');
      mobileMenu?.classList.add('opacity-100', 'pointer-events-auto');
      document.body.style.overflow = 'hidden';

      // Animate hamburger to X
      hamburgerLines[0]?.classList.add('rotate-45', 'translate-y-[4px]');
      hamburgerLines[1]?.classList.add('-rotate-45', '-translate-y-[3px]');
    } else {
      mobileMenu?.classList.add('opacity-0', 'pointer-events-none');
      mobileMenu?.classList.remove('opacity-100', 'pointer-events-auto');
      document.body.style.overflow = '';

      // Reset hamburger
      hamburgerLines[0]?.classList.remove('rotate-45', 'translate-y-[4px]');
      hamburgerLines[1]?.classList.remove('-rotate-45', '-translate-y-[3px]');
    }
  }

  menuToggle?.addEventListener('click', toggleMenu);

  // Close menu on link click
  document.querySelectorAll('.mobile-link').forEach(link => {
    link.addEventListener('click', () => {
      if (isOpen) toggleMenu();
    });
  });

  window.addEventListener('scroll', handleScroll, { passive: true });
  handleScroll();
</script>

<style>
  .nav-scrolled {
    background: rgba(10, 10, 10, 0.8);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    padding-top: 1rem;
    padding-bottom: 1rem;
  }

  .hamburger-line {
    transform-origin: center;
  }
</style>
