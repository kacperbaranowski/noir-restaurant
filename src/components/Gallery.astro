---
const galleryItems = [
  {
    image: 'https://images.unsplash.com/photo-1546039907-7fa05f864c02?w=600&q=80',
    title: 'Polędwica Wołowa',
    category: 'Danie główne'
  },
  {
    image: 'https://images.unsplash.com/photo-1551024506-0bccd828d307?w=600&q=80',
    title: 'Deser Czekoladowy',
    category: 'Słodkości'
  },
  {
    image: 'https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=600&q=80',
    title: 'Kompozycja Warzywna',
    category: 'Przystawki'
  },
  {
    image: 'https://images.unsplash.com/photo-1565299624946-b28f40a0ae38?w=600&q=80',
    title: 'Owoce Morza',
    category: 'Specjalność szefa'
  },
  {
    image: 'https://images.unsplash.com/photo-1567620905732-2d1ec7ab7445?w=600&q=80',
    title: 'Risotto Truflowe',
    category: 'Pasta'
  },
  {
    image: 'https://images.unsplash.com/photo-1540189549336-e6e99c3679fe?w=600&q=80',
    title: 'Sałatka Śródziemnomorska',
    category: 'Przystawki'
  }
];
---

<section id="galeria" class="py-24 lg:py-40 overflow-hidden">
  <div class="px-6 lg:px-16 mb-12 lg:mb-24">
    <h2 class="reveal font-[family-name:var(--font-display)] text-[clamp(2.5rem,8vw,6rem)] font-light">
      Galeria
    </h2>
  </div>

  <!-- Mobile: Horizontal scroll -->
  <div class="lg:hidden overflow-x-auto scrollbar-hide px-6">
    <div class="flex gap-4 pb-4" style="width: max-content;">
      {galleryItems.map((item) => (
        <div class="gallery-item flex-shrink-0 w-[280px] h-[350px] relative overflow-hidden rounded-sm">
          <img
            src={item.image}
            alt={item.title}
            loading="lazy"
            class="w-full h-full object-cover"
          />
          <div class="absolute bottom-0 left-0 w-full p-6 bg-gradient-to-t from-black/80 to-transparent">
            <h4 class="font-[family-name:var(--font-display)] text-xl font-normal mb-1">
              {item.title}
            </h4>
            <p class="font-[family-name:var(--font-body)] text-xs text-[var(--color-text-muted)]">
              {item.category}
            </p>
          </div>
        </div>
      ))}
    </div>
  </div>

  <!-- Desktop: GSAP Marquee -->
  <div class="hidden lg:block overflow-hidden">
    <div id="gallery-track" class="flex gap-8">
      {[...galleryItems, ...galleryItems, ...galleryItems].map((item) => (
        <div class="gallery-item flex-shrink-0 w-[450px] h-[550px] relative overflow-hidden cursor-pointer group">
          <img
            src={item.image}
            alt={item.title}
            loading="lazy"
            class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"
          />
          <div class="absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-all duration-500"></div>
          <div class="absolute bottom-0 left-0 w-full p-10 bg-gradient-to-t from-black/80 via-black/40 to-transparent translate-y-full group-hover:translate-y-0 transition-transform duration-500">
            <h4 class="font-[family-name:var(--font-display)] text-2xl font-normal mb-2">
              {item.title}
            </h4>
            <p class="font-[family-name:var(--font-body)] text-sm text-[var(--color-text-muted)]">
              {item.category}
            </p>
          </div>
        </div>
      ))}
    </div>
  </div>
</section>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const track = document.getElementById('gallery-track');
    if (!track || window.innerWidth < 1024) return;

    const items = track.querySelectorAll('.gallery-item');
    const itemWidth = 450 + 32; // width + gap
    const totalWidth = itemWidth * (items.length / 3); // Original items width

    let xPos = 0;
    let speed = 1;
    let isPaused = false;

    track.addEventListener('mouseenter', () => isPaused = true);
    track.addEventListener('mouseleave', () => isPaused = false);

    function animate() {
      if (!isPaused) {
        xPos -= speed;
        if (Math.abs(xPos) >= totalWidth) {
          xPos = 0;
        }
        track.style.transform = `translateX(${xPos}px)`;
      }
      requestAnimationFrame(animate);
    }

    animate();
  });
</script>

<style>
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  #gallery-track {
    will-change: transform;
  }
</style>
